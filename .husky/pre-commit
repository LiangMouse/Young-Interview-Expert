#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# è¿è¡Œ lint-staged (æ ¼å¼åŒ–å’Œ lint)
echo "ğŸ“ Running lint and format..."
npx lint-staged

if [ $? -ne 0 ]; then
  echo "âŒ Lint/format failed!"
  exit 1
fi

# æ£€æŸ¥æš‚å­˜åŒºæ˜¯å¦æœ‰æ–°çš„ä¿®æ”¹ï¼Œå¦‚æœæœ‰åˆ™æ·»åŠ åˆ°æš‚å­˜åŒº
if ! git diff --cached --quiet; then
  echo "ğŸ”„ Files were modified during linting, adding to staging..."
  git add .
  echo "âœ… Modified files added to staging area. Please commit again."
  exit 1
fi

echo "âœ… Pre-commit checks passed!"
